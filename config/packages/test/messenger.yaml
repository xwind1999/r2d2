framework:
    messenger:

        transports:
        # https://symfony.com/doc/current/messenger.html#transports
            broadcast-listeners-partner:
                dsn: 'doctrine://default'
                options:
                    queue_name: broadcast-listeners-partner
                retry_strategy:
                    max_retries: 10
                    delay: 60000
                    multiplier: 2

            broadcast-listeners-product:
                dsn: 'doctrine://default'
                options:
                    queue_name: broadcast-listeners-product
                retry_strategy:
                    max_retries: 10
                    delay: 60000
                    multiplier: 2

            broadcast-listeners-product-relationship:
                dsn: 'doctrine://default'
                options:
                    queue_name: broadcast-listeners-product-relationship
                retry_strategy:
                    max_retries: 10
                    delay: 60000
                    multiplier: 2

            broadcast-listeners-price-information:
                dsn: 'doctrine://default'
                options:
                    queue_name: broadcast-listeners-price-information
                retry_strategy:
                    max_retries: 10
                    delay: 60000
                    multiplier: 2

            calculate-manageable-flag:
                dsn: 'doctrine://default'
                options:
                    queue_name: calculate-manageable-flag
                retry_strategy:
                    max_retries: 0

            push-room-information:
                dsn: 'doctrine://default'
                options:
                    queue_name: push-room-information
                retry_strategy:
                    max_retries: 10
                    delay: 60000
                    multiplier: 2

            failed-broadcast-listeners:
                dsn: 'doctrine://default'
                options:
                    queue_name: failed-broadcast-listeners

            broadcast-listeners-room-availability:
                dsn: 'doctrine://default'
                options:
                    queue_name: broadcast-listeners-room-availability
                retry_strategy:
                    max_retries: 10
                    delay: 60000
                    multiplier: 2
        # sync: 'sync://'

        routing:
        # Route your messages to the transports
            'App\Contract\Request\BroadcastListener\PartnerRequest': broadcast-listeners-partner
            'App\Contract\Request\BroadcastListener\ProductRequest': broadcast-listeners-product
            'App\Contract\Request\BroadcastListener\ProductRelationshipRequest': broadcast-listeners-product-relationship
            'App\Contract\Request\BroadcastListener\PriceInformationRequest': broadcast-listeners-price-information
            'App\Contract\Request\BroadcastListener\RoomAvailabilityRequest': broadcast-listeners-room-availability
            'App\Contract\Request\Manageable\ManageableProductRequest': calculate-manageable-flag
            'App\Contract\Request\EAI\RoomRequest': push-room-information

        buses:
            default:
                middleware:
                    - App\Messenger\NewrelicMessengerMiddleware
                    - App\Messenger\MessengerLoggerMiddleware
